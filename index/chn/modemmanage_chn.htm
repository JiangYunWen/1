<html>

<head>
<meta http-equiv="Content-Type" content="text/html">

<title>System Command</title>
<script type="text/javascript" src="../util_gw.js"> </script>
<script type="text/javascript" src="../res/jquery.js"></script>
<script type="text/javascript" src="../res/sychip.js"></script>

<style type="text/css">
.white_content {
 display: none;
 position: absolute;
 top: 15%;
 left: 10%;
 width: 20%;
 height: 20%;
 border: 10px solid #808080;
 z-index:1002;
}
.black_overlay {
 display: none;
 position: absolute;
 top: 0%;
 left: 0%;
 width: 100%;
 height: 100%;
 background-color:#f5f5f5;
 z-index:1001;
 -moz-opacity: 0.6;
 opacity:.80;
 filter: alpha(opacity=100);
}

</style>
<script>
var objTimeOut = "";
var WebModemGetInfoCfunParamFun;
var WebModemGetInfoDapiParamPasswordId;
var WebModemGetInfoDaocndiParamBandBitmap;
var WebModemGetInfoDaocndiParamType;
var WebModemGetInfoDaocndiParamWorkType;
var WebModemGetInfoDstcParamConf;
var WebModemGetInfoDfhcParamN;
var WebModemGetInfoDrpsParamFreq;
var WebModemGetInfoDrpsParamBandwidth;
var WebModemGetInfoDrpsParamPower;
var WebModemGetInfoDrpcParamFreq;
var WebModemGetInfoDrpcParamBandwidth;
var WebModemGetInfoDrpCParamPower;
var WebModemGetInfoNetifcfgParamIp_br0;

//关闭等待窗口   
function closediv() {  
    //Close Div    
    document.body.removeChild(document.getElementById("bgDiv"));  
    document.getElementById("msgDiv").removeChild(document.getElementById("msgTitle"));  
    document.body.removeChild(document.getElementById("msgDiv"));  
}  
//显示等待窗口   
function showdiv(str) {  
    var msgw, msgh, bordercolor;  
    msgw = 400; //提示窗口的宽度    
    msgh = 100; //提示窗口的高度    
    bordercolor = "#336699"; //提示窗口的边框颜色    
    titlecolor = "#99CCFF"; //提示窗口的标题颜色    
  
    var sWidth, sHeight;  
    sWidth = window.screen.availWidth;  
    sHeight = window.screen.availHeight;  
  
    var bgObj = document.createElement("div");  
    bgObj.setAttribute('id', 'bgDiv');  
    bgObj.style.position = "absolute";  
    bgObj.style.top = "0";  
    bgObj.style.background = "#777";  
    bgObj.style.filter = "progid:DXImageTransform.Microsoft.Alpha(style=3,opacity=25,finishOpacity=75";  
    bgObj.style.opacity = "0.6";  
    bgObj.style.left = "0";  
    bgObj.style.width = sWidth + "px";  
    bgObj.style.height = sHeight + "px";  
    document.body.appendChild(bgObj);  
    var msgObj = document.createElement("div")  
    msgObj.setAttribute("id", "msgDiv");  
    msgObj.setAttribute("align", "center");  
    msgObj.style.position = "absolute";  
    msgObj.style.background = "white";  
    msgObj.style.font = "12px/1.6em Verdana, Geneva, Arial, Helvetica, sans-serif";  
    msgObj.style.border = "1px solid " + bordercolor;  
    msgObj.style.width = msgw + "px";  
    msgObj.style.height = msgh + "px";  
    msgObj.style.top = (document.documentElement.scrollTop + (sHeight - msgh) / 2) + "px";  
    msgObj.style.left = (sWidth - msgw) / 2 + "px";  
    var title = document.createElement("h4");  
    title.setAttribute("id", "msgTitle");  
    title.setAttribute("align", "right");  
    title.style.margin = "0";  
    title.style.padding = "3px";  
    title.style.background = bordercolor;  
    title.style.filter = "progid:DXImageTransform.Microsoft.Alpha(startX=20, startY=20, finishX=100, finishY=100,style=1,opacity=75,finishOpacity=100);";  
    title.style.opacity = "0.75";  
    title.style.border = "1px solid " + bordercolor;  
    title.style.height = "18px";  
    title.style.font = "12px Verdana, Geneva, Arial, Helvetica, sans-serif";  
    title.style.color = "white";  
    //title.style.cursor = "pointer";   
    //title.innerHTML = "关闭";   
    //title.onclick = closediv;   
    document.body.appendChild(msgObj);  
    document.getElementById("msgDiv").appendChild(title);  
    var txt = document.createElement("p");  
    txt.style.margin = "1em 0"  
    txt.setAttribute("id", "msgTxt");  
    txt.innerHTML = str;  
    document.getElementById("msgDiv").appendChild(txt);  
}  
function updatedivmsg(str) 
{ 
	var txt =document.getElementById("msgTxt");
	if(txt)
	{
		txt.innerHTML =str;	
	}
}
//屏蔽F5   
document.onkeydown = mykeydown;  

function mykeydown() {  
    if (event.keyCode == 116) //屏蔽F5刷新键      
    {  
        window.event.keyCode = 0;  
        return false;  
    }  
}   

function SetLabelText(Labelid,Text)
{
//obj_label= document.getElementById(Labid).innerHTML;
//obj_label.innerHTML=Text;
document.getElementById(Labelid).innerHTML=(Text);
}

//SetLabelText("LB_FormCfun_Param_DebugSwitch","SetLabelText web");
function Sync_Submit()
{
	var temp="/boafrm/formSyncProcess";
	disableTextField(document.getElementById("Sync_Submit"));	
	$.ajax({
		type: "POST",
		url: temp,
		cache: false,
		data:"",
		success: function(result) 
		{
//			alert("send_FormDebugSwitch: success");
			if (result != null && result.length !== 0)
			{
//				alert("send_FormDebugSwitch: openIntervals_debugswitch");
				openIntervals_sync();
			}
		},
		complete: function(xmlHttpHeader, textStatus) 
		{
//			alert("send_FormDebugSwitch: complete");
			xmlHttpHeader = null;
		}
	});
}


function send_FormCfun( param)
{
	var temp="/boafrm/formCfunProcess";
	$.ajax({
		type: "POST",
		url: temp,
		cache: false,
		data:param,
		success: function(result) 
		{
			if (result != null && result.length !== 0)
			{
				openIntervals_Cfun();
			}
		},
		complete: function(xmlHttpHeader, textStatus) 
		{
			xmlHttpHeader = null;
		}
	});
}
function FormCfun_Submit()
{
	if("255"==document.all.FormCfun.FormCfun_Param_DebugSwitch.value)
	{
		alert("请选择操作类型");
		document.all.FormCfun.FormCfun_Param_DebugSwitch.focus();
		return false;
	}
	param = "";
    param +="FormCfun_Param_DebugSwitch=";
	param += document.all.FormCfun.FormCfun_Param_DebugSwitch.value;

	disableTextField(document.getElementById("FormCfun_Button_Submit"));
//	alert("FormCfun_Submit:" + param);	
	send_FormCfun(param);
	showdiv("正在更改，请等待。。。");
//	document.all.FormCfun.submit();
}


function send_FormCfun_result_get()
{ 
	closediv();
	showdiv("正在查询更新结果。。。");
	$.ajax({
	url: "../lcModemManageCfunProcess.asp",
	cache: false,

	success: function(result) 
	{
		closediv();
		allmsg=result.split('*');
		allmsg[0] = allmsg[0].replace(/[\r\n]/g,"");
	  	allmsg[1] = allmsg[1].replace(/[\r\n]/g,"");
		enableTextField(document.getElementById("FormCfun_Button_Submit"));
		if(allmsg[0] == "success")
		{
			alert("更新成功!");
			closeIntervals();
			location.reload();
		}
		else if(allmsg[0] == "failure")
		{
			alert("更新失败!");
			closeIntervals();
			location.reload();
		}
		else
		{
			showdiv("更新失败! 继续尝试。。。");
			/*TODO:打开得了吗*/
			openIntervals_Cfun();
		}
	},	 

	complete: function(xmlHttpHeader, textStatus) {
	 	xmlHttpHeader = null;
	}
	});
}
function openIntervals_Cfun()
{
	if (objTimeOut == null || objTimeOut=="")
	{
		objTimeOut= setInterval('send_FormCfun_result_get()',2000);
	}
}

function send_FormDapi( param)
{
	var temp="/boafrm/formDapiProcess";
	$.ajax({
		type: "POST",
		url: temp,
		cache: false,
		data:param,
		success: function(result) 
		{
			if (result != null && result.length !== 0)
			{
				openIntervals_Dapi();
			}
		},
		complete: function(xmlHttpHeader, textStatus) 
		{
			xmlHttpHeader = null;
		}
	});
}
function FormDapi_Submit()
{
	if (document.getElementById("FormDapiKey").value.length != 0 )
	{
		if (document.getElementById("FormDapiKey").value.length < 1  ||  document.getElementById("FormDapiKey").value.length > 32)
		{
			alert("请输入1到32位的Key！");
			document.all.FormDapi.FormDapiKey.focus();
			return false;
		}
	}
	else
	{
		alert("Key不能为空！");
		document.all.FormDapi.FormDapiKey.focus();
		return false;
	}
	param = "";
    param +="FormDapi_Param_Key=";
	param += document.all.FormDapi.FormDapiKey.value ;
	//alert("FormDapi_Submit:"+param);
	disableTextField(document.getElementById("FormDapi_Button_Submit"));
	send_FormDapi(param);
	showdiv("正在更改，请等待。。。");
//	document.getElementById("FormKeySetKey").submit();	
//	document.all.FormKeySet.submit();	
}


function send_FormDapi_result_get()
{ 
	closediv();
	showdiv("正在查询更新结果。。。");

	//alert("send_FormDapi_result_get");
	$.ajax({
	url: "../lcModemManageDapiProcess.asp",
	cache: false,

	success: function(result) 
	{
		closediv();

		allmsg=result.split('*');
		allmsg[0] = allmsg[0].replace(/[\r\n]/g,"");
	  	allmsg[1] = allmsg[1].replace(/[\r\n]/g,"");
		//alert("send_FormDapi_result_get:"+allmsg[0]);
		if(allmsg[0] == "success")
		{
			alert("更新成功!");
			closeIntervals();
			location.reload();
		}
		else if(allmsg[0] == "failure")
		{
			alert("更新失败!");
			closeIntervals();
//			location.reload();
		}
		else
		{

			showdiv("更新失败! 继续尝试。。。");
			openIntervals_Dapi();
		}
	},	 

	complete: function(xmlHttpHeader, textStatus) {
	 	xmlHttpHeader = null;
	}
	});
}
function openIntervals_Dapi()
{
	if (objTimeOut == null || objTimeOut=="")
	{
		objTimeOut= setInterval('send_FormDapi_result_get()',2000);
	}
}

function send_FormDaocndi( param)
{
	var temp="/boafrm/formDaocndiProcess";
	$.ajax({
		type: "POST",
		url: temp,
		cache: false,
		data:param,
		success: function(result) 
		{
			if (result != null && result.length !== 0)
			{
				openIntervals_Daocndi();
			}
		},
		complete: function(xmlHttpHeader, textStatus) 
		{
			xmlHttpHeader = null;
		}
	});
}


function FormDaocndi_Submit()
{
	if("2"==document.all.FormDaocndi.FormDaocndi_Param_Band.value)
	{
		alert("请选择操作类型");
		document.all.FormDaocndi.FormDaocndi_Param_Band.focus();
		return false;
	}
	param = "";
    param +="FormDaocndi_Param_Band=";
	param += document.all.FormDaocndi.FormDaocndi_Param_Band.value;

	disableTextField(document.getElementById("FormDaocndi_Button_Submit"));
	//alert("FormDaocndi_Submit:" + param);	
	send_FormDaocndi(param);
	showdiv("正在更改，请等待。。。");
//	document.all.FormCfun.submit();
}


function send_FormDaocndi_result_get()
{ 
	closediv();
	showdiv("正在查询更新结果。。。");
	//alert("send_FormDaocndi_result_get");
	$.ajax({
	url: "../lcModemManageDaocndiProcess.asp",
	cache: false,

	success: function(result) 
	{
		closediv();
		allmsg=result.split('*');
		allmsg[0] = allmsg[0].replace(/[\r\n]/g,"");
	  	allmsg[1] = allmsg[1].replace(/[\r\n]/g,"");
		//alert("send_FormCfun_result_get:"+allmsg[0]);
		enableTextField(document.getElementById("FormDaocndi_Button_Submit"));
		if(allmsg[0] == "success")
		{
			alert("更新成功!");
			closeIntervals();
			location.reload();
		}
		else if(allmsg[0] == "failure")
		{
			alert("更新失败!");
			closeIntervals();
//			location.reload();
		}
		else
		{
			showdiv("更新失败! 继续尝试。。。");
			openIntervals_Daocndi();
		}
	},	 

	complete: function(xmlHttpHeader, textStatus) {
	 	xmlHttpHeader = null;
	}
	});
}
function openIntervals_Daocndi()
{
	if (objTimeOut == null || objTimeOut=="")
	{
		objTimeOut= setInterval('send_FormDaocndi_result_get()',2000);
	}
}




function send_FormDdtc( param)
{
	var temp="/boafrm/formDdtcProcess";
	$.ajax({
		type: "POST",
		url: temp,
		cache: false,
		data:param,
		success: function(result) 
		{
			if (result != null && result.length !== 0)
			{
				openIntervals_Ddtc();
			}
		},
		complete: function(xmlHttpHeader, textStatus) 
		{
			xmlHttpHeader = null;
		}
	});
}

function FormDdtc_Submit()
{
	if("255"==document.all.FormDdtc.FormDdtc_Param_Type.value)
	{
		alert("请选择操作类型");
		document.all.FormDdtc.FormDdtc_Param_Type.focus();
		return false;
	}
	param = "";
    param +="FormDdtc_Param_Type=";
	param += document.all.FormDdtc.FormDdtc_Param_Type.value;

	disableTextField(document.getElementById("FormDdtc_Button_Submit"));
	//alert("FormDdtc_Submit:" + param);	
	send_FormDdtc(param);
	showdiv("正在更改，请等待。。。");
//	document.all.FormCfun.submit();
}


function send_FormDdtc_result_get()
{ 
	closediv();
	showdiv("正在查询更新结果。。。");
	//alert("send_FormDdtc_result_get");
	$.ajax({
	url: "../lcModemManageDdtcProcess.asp",
	cache: false,

	success: function(result) 
	{
		closediv();
		allmsg=result.split('*');
		allmsg[0] = allmsg[0].replace(/[\r\n]/g,"");
	  	allmsg[1] = allmsg[1].replace(/[\r\n]/g,"");
		//alert("send_FormCfun_result_get:"+allmsg[0]);
		enableTextField(document.getElementById("FormDdtc_Button_Submit"));
		if(allmsg[0] == "success")
		{
			alert("更新成功!");
			closeIntervals();
			location.reload();
		}
		else if(allmsg[0] == "failure")
		{
			alert("更新失败!");
			closeIntervals();
//			location.reload();
		}
		else
		{
			showdiv("更新失败! 继续尝试。。。");
			openIntervals_Ddtc();
		}
	},	 

	complete: function(xmlHttpHeader, textStatus) {
	 	xmlHttpHeader = null;
	}
	});
}
function openIntervals_Ddtc()
{
	if (objTimeOut == null || objTimeOut=="")
	{
		objTimeOut= setInterval('send_FormDdtc_result_get()',2000);
	}
}


function send_FormDstc( param)
{
	var temp="/boafrm/formDstcProcess";
	$.ajax({
		type: "POST",
		url: temp,
		cache: false,
		data:param,
		success: function(result) 
		{
			if (result != null && result.length !== 0)
			{
				openIntervals_Dstc();
			}
		},
		complete: function(xmlHttpHeader, textStatus) 
		{
			xmlHttpHeader = null;
		}
	});
}

function FormDstc_Submit()
{
	if("255"==document.all.FormDstc.FormDstc_Param_Conf.value)
	{
		alert("请选择操作类型");
		document.all.FormDstc.FormDstc_Param_Conf.focus();
		return false;
	}
	param = "";
    param +="FormDstc_Param_Conf=";
	param += document.all.FormDstc.FormDstc_Param_Conf.value;

	disableTextField(document.getElementById("FormDstc_Button_Submit"));
	//alert("FormDstc_Submit:" + param);	
	send_FormDstc(param);
	showdiv("正在更改，请等待。。。");
//	document.all.FormCfun.submit();
}


function send_FormDstc_result_get()
{ 
	closediv();
	showdiv("正在查询更新结果。。。");
	//alert("send_FormDstc_result_get");
	$.ajax({
	url: "../lcModemManageDstcProcess.asp",
	cache: false,

	success: function(result) 
	{
		closediv();
		allmsg=result.split('*');
		allmsg[0] = allmsg[0].replace(/[\r\n]/g,"");
	  	allmsg[1] = allmsg[1].replace(/[\r\n]/g,"");
		//alert("send_FormCfun_result_get:"+allmsg[0]);
		enableTextField(document.getElementById("FormDstc_Button_Submit"));
		if(allmsg[0] == "success")
		{
			alert("更新成功!");
			closeIntervals();
			location.reload();
		}
		else if(allmsg[0] == "failure")
		{
			alert("更新失败!");
			closeIntervals();
//			location.reload();
		}
		else
		{
			showdiv("更新失败! 继续尝试。。。");
			openIntervals_Dstc();
		}
	},	 

	complete: function(xmlHttpHeader, textStatus) {
	 	xmlHttpHeader = null;
	}
	});
}
function openIntervals_Dstc()
{
	if (objTimeOut == null || objTimeOut=="")
	{
		objTimeOut= setInterval('send_FormDstc_result_get()',2000);
	}
}


function send_FormNetifcfg( param)
{
	var temp="/boafrm/formNetifcfgProcess";
	var varajax=$.ajax({
		type: "POST",
		url: temp,
		cache: false,
		timeout : 4000, //超时时间设置，单位毫秒
		data:param,
		success: function(result) 
		{
			if (result != null && result.length !== 0)
			{
				openIntervals_Netifcfg();
			}
		},
		complete: function(xmlHttpHeader, textStatus) 
		{
			xmlHttpHeader = null;
	　　　　if(textStatus=='timeout'){//超时,status还有success,error等值的情况
	 　　　　　 varajax.abort();
				param = "";
				param +=document.getElementsByName("IPInput")[0].value;
				param +=".";
				param +=document.getElementsByName("IPInput")[1].value;
				param +=".";
				param +=document.getElementsByName("IPInput")[2].value;
				param +=".";	
				param +=document.getElementsByName("IPInput")[3].value;

				closediv();
	 			//alert("尝试跳转新IP地址"+param);
				showdiv("尝试跳转新IP地址:"+param);
				top.location.href="http://"+param;
	　　　　}
		}
	});
}

function FormNetifcfg_Submit()
{
	var i;
	for(i=0;i<4;i++)
	{
		if((document.getElementsByName("IPInput")[i].value =="" )
			||(document.getElementsByName("IPInput")[i].value >255))
		{
			alert("IP地址不合法");
			document.getElementsByName("IPInput")[i].focus();
			return false;
		}
	}
	param = "";
    param +="FormNetifcfg_Param_Ip=";
    param +=document.getElementsByName("IPInput")[0].value;
    param +=".";
    param +=document.getElementsByName("IPInput")[1].value;
    param +=".";
	param +=document.getElementsByName("IPInput")[2].value;
    param +=".";	
	param +=document.getElementsByName("IPInput")[3].value;
	disableTextField(document.getElementById("FormNetifcfg_Button_Submit"));
	//alert("FormNetifcfg_Submit:" + param);	
	send_FormNetifcfg(param);
	showdiv("正在更改，请等待。。。");
//	document.all.FormCfun.submit();
}


function send_FormNetifcfg_result_get()
{ 
	closediv();
	showdiv("正在查询更新结果。。。");
	//alert("send_FormNetifcfg_result_get");
	$.ajax({
	url: "../lcModemManageNetifcfgProcess.asp",
	cache: false,

	success: function(result) 
	{
		closediv();
		allmsg=result.split('*');
		allmsg[0] = allmsg[0].replace(/[\r\n]/g,"");
	  	allmsg[1] = allmsg[1].replace(/[\r\n]/g,"");
		//alert("send_FormCfun_result_get:"+allmsg[0]);
		enableTextField(document.getElementById("FormNetifcfg_Button_Submit"));
		if(allmsg[0] == "success")
		{
			param = "";
		    param +=document.getElementsByName("IPInput")[0].value;
		    param +=".";
		    param +=document.getElementsByName("IPInput")[1].value;
		    param +=".";
			param +=document.getElementsByName("IPInput")[2].value;
		    param +=".";	
			param +=document.getElementsByName("IPInput")[3].value;
			alert("更新成功!请使用地址:"+param+"登陆访问");
			closeIntervals();
//			location.reload();
			window.location.href="http://"+param;
		}
		else if(allmsg[0] == "failure")
		{
			alert("更新失败!");
			closeIntervals();
//			location.reload();
		}
		else
		{
			showdiv("更新失败! 继续尝试。。。");	
			openIntervals_Netifcfg();
		}
	},	 

	complete: function(xmlHttpHeader, textStatus) {
	 	xmlHttpHeader = null;
	}
	});
}
function openIntervals_Netifcfg()
{
	if (objTimeOut == null || objTimeOut=="")
	{
		objTimeOut= setInterval('send_FormNetifcfg_result_get()',2000);
	}
}


function send_FormDrps( param)
{
	var temp="/boafrm/formDrpsProcess";
	$.ajax({
		type: "POST",
		url: temp,
		cache: false,
		data:param,
		success: function(result) 
		{
			if (result != null && result.length !== 0)
			{
				openIntervals_Drps();
			}
		},
		complete: function(xmlHttpHeader, textStatus) 
		{
			xmlHttpHeader = null;
		}
	});
}

function FormDrps_Submit()
{
	if("255"==document.all.FormDrps.FormDrps_Param_Bandwidth.value)
	{
		alert("请选择操作类型");
		document.all.FormDrps.FormDrps_Param_Bandwidth.focus();
		return false;
	}
	param = "";
    param +="FormDrps_Param_Bandwidth=";
	param += document.all.FormDrps.FormDrps_Param_Bandwidth.value;

	disableTextField(document.getElementById("FormDrps_Button_Submit"));
	//alert("FormDrps_Submit:" + param);	
	send_FormDrps(param);
	showdiv("正在更改，请等待。。。");
//	document.all.FormCfun.submit();
}


function send_FormDrps_result_get()
{ 
	closediv();
	showdiv("正在查询更新结果。。。");
	//alert("send_FormDrps_result_get");
	$.ajax({
	url: "../lcModemManageDrpsProcess.asp",
	cache: false,

	success: function(result) 
	{
		closediv();
		allmsg=result.split('*');
		allmsg[0] = allmsg[0].replace(/[\r\n]/g,"");
	  	allmsg[1] = allmsg[1].replace(/[\r\n]/g,"");
		//alert("send_FormCfun_result_get:"+allmsg[0]);
		enableTextField(document.getElementById("FormDrps_Button_Submit"));
		if(allmsg[0] == "success")
		{
			alert("更新成功!");
			closeIntervals();
			location.reload();
		}
		else if(allmsg[0] == "failure")
		{
			alert("更新失败!");
			closeIntervals();
//			location.reload();
		}
		else
		{
			showdiv("更新失败! 继续尝试。。。");	
			openIntervals_Drps();
		}
	},	 

	complete: function(xmlHttpHeader, textStatus) {
	 	xmlHttpHeader = null;
	}
	});
}
function openIntervals_Drps()
{
	if (objTimeOut == null || objTimeOut=="")
	{
		objTimeOut= setInterval('send_FormDrps_result_get()',2000);
	}
}

function modem_sync_result_get()
{ 
	alert("modem_sync_result_get");
	$.ajax({
	url: "../lcModemManage_Sync.asp",
	cache: false,

	success: function(result) 
	{
		allmsg=result.split('*');
		allmsg[0] = allmsg[0].replace(/[\r\n]/g,"");
	  	allmsg[1] = allmsg[1].replace(/[\r\n]/g,"");
		alert("modem_sync_result_get:"+allmsg[0]);
		enableTextField(document.getElementById("Sync_Submit"));
		if(allmsg[0] == "success")
		{
			alert("操作成功!");
			closeIntervals();
			location.reload();
		}
		else if(allmsg[0] == "failure")
		{
			alert("操作失败!");
			closeIntervals();
//			location.reload();
		}
		else
		{
			alert("操作失败! openIntervals_sync");
			/*TODO:打开得了吗*/
			openIntervals_sync();
		}
	},	 

	complete: function(xmlHttpHeader, textStatus) {
	 	xmlHttpHeader = null;
	}
	});
}

// 打开定时器
function openIntervals_sync()
{
	if (objTimeOut == null || objTimeOut=="")
	{
		objTimeOut= setInterval('modem_sync_result_get()',2000);
	}
}


function send_FormDfhc( param)
{
	var temp="/boafrm/formDfhcProcess";
	$.ajax({
		type: "POST",
		url: temp,
		cache: false,
		data:param,
		success: function(result) 
		{
			if (result != null && result.length !== 0)
			{
				openIntervals_Dfhc();
			}
		},
		complete: function(xmlHttpHeader, textStatus) 
		{
			xmlHttpHeader = null;
		}
	});
}

function FormDfhc_Submit()
{
	if("255"==document.all.FormDfhc.FormDfhc_Param_N.value)
	{
		alert("请选择操作类型");
		document.all.FormDfhc.FormDfhc_Param_N.focus();
		return false;
	}
	param = "";
    param +="FormDfhc_Param_N=";
	param += document.all.FormDfhc.FormDfhc_Param_N.value;

	disableTextField(document.getElementById("FormDfhc_Button_Submit"));
	//alert("FormDfhc_Submit:" + param);	
	send_FormDfhc(param);
	showdiv("正在更改，请等待。。。");
//	document.all.FormCfun.submit();
}


function send_FormDfhc_result_get()
{ 
	closediv();
	showdiv("正在查询更新结果。。。");
	//alert("send_FormDfhc_result_get");
	$.ajax({
	url: "../lcModemManageDfhcProcess.asp",
	cache: false,

	success: function(result) 
	{
		closediv();
		allmsg=result.split('*');
		allmsg[0] = allmsg[0].replace(/[\r\n]/g,"");
	  	allmsg[1] = allmsg[1].replace(/[\r\n]/g,"");
		//alert("send_FormCfun_result_get:"+allmsg[0]);
		enableTextField(document.getElementById("FormDfhc_Button_Submit"));
		if(allmsg[0] == "success")
		{
			alert("更新成功!");
			closeIntervals();
			location.reload();
		}
		else if(allmsg[0] == "failure")
		{
			alert("更新失败!");
			closeIntervals();
//			location.reload();
		}
		else
		{
			showdiv("更新失败! 继续尝试。。。");	
			openIntervals_Dfhc();
		}
	},	 

	complete: function(xmlHttpHeader, textStatus) {
	 	xmlHttpHeader = null;
	}
	});
}
function openIntervals_Dfhc()
{
	if (objTimeOut == null || objTimeOut=="")
	{
		objTimeOut= setInterval('send_FormDfhc_result_get()',2000);
	}
}


function send_FormDrpc( param)
{
	var temp="/boafrm/formDrpcProcess";
	$.ajax({
		type: "POST",
		url: temp,
		cache: false,
		data:param,
		success: function(result) 
		{
			if (result != null && result.length !== 0)
			{
				openIntervals_Drpc();
			}
		},
		complete: function(xmlHttpHeader, textStatus) 
		{
			xmlHttpHeader = null;
		}
	});
}
function GetRadioValueByName(RadioName)
{
	var item = null;
	var obj = document.getElementsByName(RadioName);
	for(var i=0;i<obj.length;i++)
	{
		if(obj[i].checked)
		{
			item =obj[i].value;
		}
	}
	return item;
}

function isInteger(obj) {
    return (parseInt(obj, 10) === obj)
}

function isNumber(name) //数值检测 
{ 
if(name.length == 0) 
return false; 
for(i = 0; i < name.length; i++) { 
if(name.charAt(i) < "0" || name.charAt(i) > "9") 
return false; 
} 
return true; 
} 


function FormDrpc_Submit()
{

	if(("255"==document.all.FormDrpc.FormDrpc_Param_Bandwidth.value)
		&& (""==document.all.FormDrpc.FormDrpc_Param_Power.value)
		&& (""==document.all.FormDrpc.FormDrpc_Param_Freq.value))
	{
		alert("没有设置更改参数");
		document.all.FormDrpc.FormDrpc_Param_Bandwidth.focus();
		return false;
	}
	if("255"==document.all.FormDrpc.FormDrpc_Param_Bandwidth.value)
	{
		document.all.FormDrpc.FormDrpc_Param_Bandwidth.value="";
	}
	if(""!=document.all.FormDrpc.FormDrpc_Param_Power.value)
	{
		if(true == isNumber(document.all.FormDrpc.FormDrpc_Param_Power.value))
		{
			if((document.all.FormDrpc.FormDrpc_Param_Power.value<1) ||
				(document.all.FormDrpc.FormDrpc_Param_Power.value>25))
			{
				alert("请选输入正确数值(1~25)");
				document.all.FormDrpc.FormDrpc_Param_Power.focus();
				return false;
			}
		}
		else
		{
			alert("请选输入正确数值(1~25)");
			document.all.FormDrpc.FormDrpc_Param_Power.focus();
			return false;
		}
	}
	if(""!=document.all.FormDrpc.FormDrpc_Param_Freq.value)
	{
		if(true == isNumber(document.all.FormDrpc.FormDrpc_Param_Freq.value))
		{
			if(!( ((document.all.FormDrpc.FormDrpc_Param_Freq.value>=24015) &&(document.all.FormDrpc.FormDrpc_Param_Freq.value<=24814))
				||((document.all.FormDrpc.FormDrpc_Param_Freq.value>=8060) &&(document.all.FormDrpc.FormDrpc_Param_Freq.value<=8259))
				||((document.all.FormDrpc.FormDrpc_Param_Freq.value>=14279) &&(document.all.FormDrpc.FormDrpc_Param_Freq.value<=14478))
				))
			{
				alert("请选输入正确数值24015-24814,8060-8259,14279-14478");
				document.all.FormDrpc.FormDrpc_Param_Freq.focus();
				return false;
			}
		}
		else
		{
			alert("请选输入正确数值24015-24814,8060-8259,14279-14478");
			document.all.FormDrpc.FormDrpc_Param_Freq.focus();
			return false;
		}	
	}
/*	if(1==GetRadioValueByName("DrpcRadio"))
	{
		if("255"==document.all.FormDrpc.FormDrpc_Param_Bandwidth.value)
		{
			alert("请选择操作类型");
			document.all.FormDrpc.FormDrpc_Param_Bandwidth.focus();
			return false;
		}
	}
	else if(2==GetRadioValueByName("DrpcRadio"))
	{
		if(true == isNumber(document.all.FormDrpc.FormDrpc_Param_Power.value))
		{
			if((document.all.FormDrpc.FormDrpc_Param_Power.value<1) ||
				(document.all.FormDrpc.FormDrpc_Param_Power.value>25))
			{
				alert("请选输入正确数值(1~25)");
				document.all.FormDrpc.FormDrpc_Param_Power.focus();
				return false;
			}
		}
		else
		{
			alert("请选输入正确数值(1~25)");
			document.all.FormDrpc.FormDrpc_Param_Power.focus();
			return false;
		}
	}
	else if(3==GetRadioValueByName("DrpcRadio"))
	{
		if(true == isNumber(document.all.FormDrpc.FormDrpc_Param_Freq.value))
		{
			if(!( ((document.all.FormDrpc.FormDrpc_Param_Freq.value>=24015) &&(document.all.FormDrpc.FormDrpc_Param_Freq.value<=24814))
				||((document.all.FormDrpc.FormDrpc_Param_Freq.value>=8060) &&(document.all.FormDrpc.FormDrpc_Param_Freq.value<=8259))
				||((document.all.FormDrpc.FormDrpc_Param_Freq.value>=14279) &&(document.all.FormDrpc.FormDrpc_Param_Freq.value<=14478))
				))
			{
				alert("请选输入正确数值24015-24814,8060-8259,14279-14478");
				document.all.FormDrpc.FormDrpc_Param_Freq.focus();
				return false;
			}
		}
		else
		{
			alert("请选输入正确数值24015-24814,8060-8259,14279-14478");
			document.all.FormDrpc.FormDrpc_Param_Freq.focus();
			return false;
		}
	}
*/		
	
	param = "";
    param +="DrpcRadio="+GetRadioValueByName("DrpcRadio");
    param +="&";	
    param +="FormDrpc_Param_Bandwidth="+document.all.FormDrpc.FormDrpc_Param_Bandwidth.value;	
    param +="&";	
    param +="FormDrpc_Param_Power="+document.all.FormDrpc.FormDrpc_Param_Power.value;
    param +="&";	
    param +="FormDrpc_Param_Freq="+document.all.FormDrpc.FormDrpc_Param_Freq.value;
	disableTextField(document.getElementById("FormDrpc_Button_Submit"));
	//alert("FormDrpc_Submit:" + param);
	send_FormDrpc(param);
	showdiv("正在更改，请等待。。。");
//	document.all.FormCfun.submit();
}


function send_FormDrpc_result_get()
{ 
	closediv();
	showdiv("正在查询更新结果。。。");
	//alert("send_FormDrpc_result_get");
	$.ajax({
	url: "../lcModemManageDrpcProcess.asp",
	cache: false,

	success: function(result) 
	{
		closediv();
		allmsg=result.split('*');
		allmsg[0] = allmsg[0].replace(/[\r\n]/g,"");
	  	allmsg[1] = allmsg[1].replace(/[\r\n]/g,"");
		//alert("send_FormCfun_result_get:"+allmsg[0]);
		enableTextField(document.getElementById("FormDrpc_Button_Submit"));
		if(allmsg[0] == "success")
		{
			alert("更新成功!");
			closeIntervals();
			location.reload();
		}
		else if(allmsg[0] == "failure")
		{
			alert("更新失败!");		
			closeIntervals();
//			location.reload();
		}
		else
		{
			showdiv("更新失败! 继续尝试。。。");
			openIntervals_Drpc();
		}
	},	 

	complete: function(xmlHttpHeader, textStatus) {
	 	xmlHttpHeader = null;
	}
	});
}
function openIntervals_Drpc()
{
	if (objTimeOut == null || objTimeOut=="")
	{
		objTimeOut= setInterval('send_FormDrpc_result_get()',2000);
	}
}

//关闭定时器
function closeIntervals()
{
	clearInterval(objTimeOut);
	objTimeOut=null;
}

function init()
{
	var TmpString="";

	
	/*调试开关at+cfun*/
	WebModemGetInfoCfunParamFun =<%getInfo("ModemGetInfoCfunParamFun");%>;
	if(0==WebModemGetInfoCfunParamFun)
	{
		SetLabelText("LB_FormCfun_Param_DebugSwitch","关闭");
	}
	else if(1==WebModemGetInfoCfunParamFun)
	{
		SetLabelText("LB_FormCfun_Param_DebugSwitch","开启");	
		/*禁止按钮*/
		disableTextField(document.getElementById("FormDapi_Button_Submit"));		
		disableTextField(document.getElementById("FormDdtc_Button_Submit"));
	}
	else
	{
		alert("ModemGetInfoCfunParamFun 参数获取错误! value = "+WebModemGetInfoCfunParamFun );
	}
	
	/*密钥设置at^dapi*/
	WebModemGetInfoDapiParamPasswordId =""
	WebModemGetInfoDapiParamPasswordId +=<%getInfo("ModemGetInfoDapiParamPasswordId");%>; 
	SetLabelText("LB_FormDapiKeyOld",WebModemGetInfoDapiParamPasswordId);

	/*频段设置 at^daocndi*/
	WebModemGetInfoDaocndiParamBandBitmap=<%getInfo("ModemGetInfoDaocndiParamBandBitmap");%>; 	
	TmpString ="";
	if(0!=(WebModemGetInfoDaocndiParamBandBitmap&(~13)))
	{
		TmpString ="不能识别 WebModemGetInfoDaocndiParamBandBitmap = "+WebModemGetInfoDaocndiParamBandBitmap;
		SetLabelText("LB_FormDaocndi_Param_Band",TmpString);		
	}
	else
	{
		TmpString ="{"
		if(1 & WebModemGetInfoDaocndiParamBandBitmap)
		{
			TmpString=TmpString+"800M频段;";
		}
		if(4 & WebModemGetInfoDaocndiParamBandBitmap)
		{
			TmpString=TmpString+"1.4G频段;";
		}
		
		if(8 & WebModemGetInfoDaocndiParamBandBitmap)
		{
			TmpString=TmpString+"2.4G频段;";

		}
		TmpString=TmpString+"}";
		SetLabelText("LB_FormDaocndi_Param_Band",TmpString);			
	}

	/*主从设置*/
	WebModemGetInfoDaocndiParamType=<%getInfo("ModemGetInfoDdtcParamType");%>; 
	WebModemGetInfoDaocndiParamWorkType=<%getInfo("ModemGetInfoDdtcParamWorkType");%>;
	TmpString ="";
	if(0 == WebModemGetInfoDaocndiParamType)
	{
		TmpString ="自动";	
	}
	else if (1 == WebModemGetInfoDaocndiParamType)
	{
		TmpString ="中心节点";
	}
	else if (2 == WebModemGetInfoDaocndiParamType)
	{
		TmpString ="接入节点";
	}
	else
	{
		TmpString ="不能识别 WebModemGetInfoDaocndiParamType = "+WebModemGetInfoDaocndiParamType;
	}
	SetLabelText("LB_FormDdtc_Param_Type",TmpString);

	TmpString ="";
	if(0 == WebModemGetInfoDaocndiParamWorkType)
	{
		TmpString ="自动";	
	}
	else if (1 == WebModemGetInfoDaocndiParamWorkType)
	{
		TmpString ="中心节点";
	}
	else if (2 == WebModemGetInfoDaocndiParamWorkType)
	{
		TmpString ="接入节点";
	}
	else
	{
		TmpString ="不能识别 WebModemGetInfoDaocndiParamWorkType = "+WebModemGetInfoDaocndiParamWorkType;
	}
	SetLabelText("LB_FormDdtc_Param_WorkType",TmpString);

	/*上下行比*/
	WebModemGetInfoDstcParamConf =<%getInfo("ModemGetInfoDstcParamConf");%>; 
	TmpString ="";
	if(0 == WebModemGetInfoDstcParamConf)
	{
		TmpString ="config0(2D3U) ";	
	}
	else if (1 == WebModemGetInfoDstcParamConf)
	{
		TmpString ="config1(3D2U)";
	}
	else if (2 == WebModemGetInfoDstcParamConf)
	{
		TmpString ="config2(4D1U) ";
	}
	else
	{
		TmpString ="不能识别 WebModemGetInfoDstcParamConf= "+WebModemGetInfoDstcParamConf;
	}	
	SetLabelText("LB_FormDstc_Param_Conf",TmpString);
	/*跳频开关*/
	WebModemGetInfoDfhcParamN =<%getInfo("ModemGetInfoDfhcParamN");%>;
	TmpString ="";
	if(0 == WebModemGetInfoDfhcParamN)
	{
		TmpString ="关闭";	
	}
	else if (1 == WebModemGetInfoDfhcParamN)
	{
		TmpString ="开启";
	}
	else
	{
		TmpString ="不能识别 WebModemGetInfoDfhcParamN= "+WebModemGetInfoDfhcParamN;
	}
	SetLabelText("LB_FormDfhc_Param_N",TmpString);

	/*Radio Parameter Store in NVRAM at^drps*/
	WebModemGetInfoDrpsParamBandwidth=<%getInfo("ModemGetInfoDrpsParamBandwidth");%>; 
		/*暂时不用 WebModemGetInfoDrpsParamPower=<%getInfo("ModemGetInfoDrpsParamPower");%>; */
	TmpString ="";
	if(0 == WebModemGetInfoDrpsParamBandwidth)
	{
		TmpString ="1.4M";	
	}
	else if (1 == WebModemGetInfoDrpsParamBandwidth)
	{
		TmpString ="3M";
	}
	else if (2 == WebModemGetInfoDrpsParamBandwidth)
	{
		TmpString ="5M";
	}
	else if (3 == WebModemGetInfoDrpsParamBandwidth)
	{
		TmpString ="10M";
	}
	else if (4 == WebModemGetInfoDrpsParamBandwidth)
	{
		TmpString ="15M";
	}
	else if (5 == WebModemGetInfoDrpsParamBandwidth)
	{
		TmpString ="20M";
	}	
	else
	{
		TmpString ="不能识别 WebModemGetInfoDrpsParamBandwidth= "+WebModemGetInfoDrpsParamBandwidth;
	}
	SetLabelText("LB_FormDrps_Param_Bandwidth",TmpString);
	
	/*Radio Parameter Configure at^drpc*/
	WebModemGetInfoDrpcParamFreq=<%getInfo("ModemGetInfoDrpcParamFreq");%>;/*1_ModemGetInfoDrpcParamFreq*/
	WebModemGetInfoDrpcParamBandwidth=<%getInfo("ModemGetInfoDrpcParamBandwidth");%>;/*1_ModemGetInfoDrpcParamBandwidth*/
	WebModemGetInfoDrpcParamPower=<%getInfo("ModemGetInfoDrpcParamPower");%>;/*1_ModemGetInfoDrpcParamPower*/
	/*-->DrpcParamFreq*/
	TmpString ="";
	//TODO:合法性盘点
	TmpString=TmpString+WebModemGetInfoDrpcParamFreq;
	SetLabelText("LB_FormDrpc_Param_Freq",TmpString);	

	/*-->DrpcParamPower*/
	TmpString ="";
	//TODO:合法性盘点
	TmpString=TmpString+WebModemGetInfoDrpcParamPower;
	SetLabelText("LB_FormDrpc_Param_Power",TmpString);	
	
	/*-->DrpcParamBandwidth*/
	TmpString ="";
	if(0 == WebModemGetInfoDrpcParamBandwidth)
	{
		TmpString ="1.4M";	
	}
	else if (1 == WebModemGetInfoDrpcParamBandwidth)
	{
		TmpString ="3M";
	}
	else if (2 == WebModemGetInfoDrpcParamBandwidth)
	{
		TmpString ="5M";
	}
	else if (3 == WebModemGetInfoDrpcParamBandwidth)
	{
		TmpString ="10M";
	}
	else if (4 == WebModemGetInfoDrpcParamBandwidth)
	{
		TmpString ="15M";
	}
	else if (5 == WebModemGetInfoDrpcParamBandwidth)
	{
		TmpString ="20M";
	}	
	else
	{
		TmpString ="不能识别 WebModemGetInfoDrpcParamBandwidth= "+WebModemGetInfoDrpcParamBandwidth;
	}
	SetLabelText("LB_FormDrpc_Param_Bandwidth",TmpString);


	/*IP设置at^netifcfg= */
	WebModemGetInfoNetifcfgParamIp_br0 = <%getInfo("ModemGetInfoNetifcfgParamIp_br0");%>; 
	TmpString =""+WebModemGetInfoNetifcfgParamIp_br0;
	SetLabelText("LB_FormNetifcfg_Param_Ip_Br0",TmpString);
}
</script>
</head>
<blockquote>
<h3><font color="#0000FF">自组网节点配置管理</font></h3>

<body  onLoad="init()">

 <table border="0" cellspacing="0" width="600">
 <tr><hr size=1 noshade align=top></tr>
</table>

<div id=idDivenglish style="display:block">
  <table border=0 width="600" cellspacing=0 cellpadding=0>

<form id="FormCfun" name="FormCfun" >
  <table>
  	<tr> 
      <td colspan=3 ><font size="2" weight="bold" ><b>调试开关:</b></font></td>
    </tr>   
    <tr> 
	<td >当前状态:[<label id="LB_FormCfun_Param_DebugSwitch">LB_FormCfun_Param_DebugSwitch</label>]</td>        
      <td ><font size="2" weight="bold" >
	    <select name="FormCfun_Param_DebugSwitch" id="FormCfun_Param_DebugSwitch">
          <option value='0'>关闭</option>
          <option value='1' >开启</option>
          <option value='255' selected ="selected">选择操作</option>
        </select> </font>
        
        </td>
        <td><input type="button" value="确定" id="FormCfun_Button_Submit"  onClick="FormCfun_Submit();">  </td>
    </tr>
  </table>
</form>

<form id="FormDapi" name="FormDapi" >
  <table>
  	<tr> 
      <td ><font size="2" weight="bold" ><b>密钥设置(1-32位)(飞行模式下设置):</b></font></td>
    </tr>  
	 <tr>
    	<td >当前Key:[<label id="LB_FormDapiKeyOld">LB_FormDapiKeyOld</label>]</td>     	 
	 <tr>
      <td width ="75%"><font size="2" weight="bold" >
      新Key
      	<input type="text" class="txt1"  name="FormDapiKey" maxlength="32" size="32" id="FormDapiKey"></font></td> 
    </tr>
  	<tr> 
      <td ><input type="button" value="确定" id="FormDapi_Button_Submit"  onClick="FormDapi_Submit();">  </td>
    </tr>  
    
  </table>
</form>

<form id="FormDaocndi" name="FormDaocndi">
  <table>
  	<tr> 
      <td colspan=3 ><font size="2" weight="bold" ><b>频段设置(设置后重新上电开机进出飞行生效):</b></font></td>
    </tr>   
    <tr> 
    	<td >当前值:<label id="LB_FormDaocndi_Param_Band">LB_FormDaocndi_Param_Band</label></td>      
      <td ><font size="2" weight="bold" >
	    <select name="FormDaocndi_Param_Band" id="FormDaocndi_Param_Band">
          <option value='1'>800M频段</option>
          <option value='4'>1.4G频段</option>
          <option value='8'>2.4G频段</option>
          <option value='255' selected ="selected">选择操作</option>          
        </select> </font></td>
        <td><input type="button" value="确定" id="FormDaocndi_Button_Submit"  onClick="FormDaocndi_Submit();"> </td>
    </tr>
  </table>

</form>

<form id="FormDdtc" name="FormDdtc">
  <table>
  	<tr> 
      <td colspan=3 ><font size="2" weight="bold" ><b>主从设置(开机之前设置,开机之后生效):</b></font></td>
    </tr>  
    <tr> 
    	<td >当前类型:[<label id="LB_FormDdtc_Param_Type">LB_FormDdtc_Param_Type</label>]工作类型:[<label id="LB_FormDdtc_Param_WorkType">LB_FormDdtc_Param_WorkType]</label>]</td>     
      <td ><font size="2" weight="bold" >
	    <select name="FormDdtc_Param_Type" id="FormDdtc_Param_Type">
          <option value='1'>中心节点</option>
          <option value='2'>接入节点</option>
          <option value='255' selected ="selected">选择操作</option>          
        </select> </font></td>
        <td><input type="button" value="确定" id="FormDdtc_Button_Submit"  onClick="FormDdtc_Submit();">  </td>
    </tr>
  </table>
</form>

<form id="FormDstc" name="FormDstc">
  <table>
	<tr> 
      <td colspan=3 ><font size="2" weight="bold" ><b>上下行比(设置后进出飞行下电重新开机生效):</b></font></td>
    </tr>  
    <tr> 
    	<td >当前值:[<label id="LB_FormDstc_Param_Conf">LB_FormDstc_Param_Conf</label>]</td>  
      <td ><font size="2" weight="bold" >
	    <select name="FormDstc_Param_Conf" id="FormDstc_Param_Conf">
          <option value='0'>config0(2D3U)</option>
          <option value='1'>config1(3D2U)</option>
          <option value='2'>config2(4D1U) </option>
          <option value='255' selected ="selected">选择操作</option>          
        </select> </font></td>
	<td><input type="button" value="确定" id="FormDstc_Button_Submit"  onClick="FormDstc_Submit();">  </td>        
    </tr>
  </table>
</form>

<style>
div.IPDiv{background:#ffffff;width:120;font-size:9pt;text-align:center;border:2 ridge threedshadow;border-right:inset threedhighlight;border-bottom:inset threedhighlight; } input.IPInput{width:24;font-size:9pt;text-align:center;border-width:0; } 
</style> 
<script language="JScript" >
// 获取光标位置 
function getCursortPosition (textDom) 
{  
	var cursorPos = 0;  
	if (document.selection) 
	{   
	// IE Support   
	textDom.focus ();   
	var selectRange = document.selection.createRange();   
	selectRange.moveStart ('character', -textDom.value.length);   
	cursorPos = selectRange.text.length;  
	}
	else if (textDom.selectionStart || textDom.selectionStart == '0') 
	{   // Firefox support   
	cursorPos = textDom.selectionStart;  
	}  
	return cursorPos; 
} 	
function IPKeydown(i)
{
	if((event.keyCode==39) )//右箭头
	{
		if(i<3)
		{
			if(event.srcElement.value.length==getCursortPosition(event.srcElement))
			{
				document.getElementsByName("IPInput")[i+1].focus();
				//event.keyCode = 9;//TAB
				return true;
			}
		}
		return true;
	}
	if((event.keyCode==190)||(event.keyCode==110))//.
	{
		if(i<3)
		{
			if(event.srcElement.value.length==getCursortPosition(event.srcElement))
			{
				document.getElementsByName("IPInput")[i+1].focus();
				event.returnValue =false;	
				return true;
			}
		}
		event.returnValue =false;
		return true;
	}	
	if(event.keyCode==37)//左箭头
	{
//		alert(getCursortPosition(event.srcElement))
		if(i>0)
		{
			if(getCursortPosition(event.srcElement)==0)
			{
				document.getElementsByName("IPInput")[i-1].focus();
				document.getElementsByName("IPInput")[i-1].value=document.getElementsByName("IPInput")[i-1].value;
		    	event.returnValue =false;			
		    	return true;
	  		}
		}
		return true;
	}
	if(event.keyCode==8)//Backspace
	{
//		alert(getCursortPosition(event.srcElement))
		if(getCursortPosition(event.srcElement)>0)
		{
			return true;
		}
		else
		{
			if(i>0)
			{
					document.getElementsByName("IPInput")[i-1].focus();
					document.getElementsByName("IPInput")[i-1].value=document.getElementsByName("IPInput")[i-1].value;
		    	return true;
			}
			else
			{
		    	event.returnValue =false;			
		    	return true;
			}
		}
	}	
	if(event.keyCode==9)//TAB
	{
		return true;
	}
	if(event.keyCode==46)//DEL
	{
		return true;
	}		
	if(event.keyCode==13)//回车
	{
		event.keyCode=9;
		return true;
	}
	if(event.keyCode==144)//NumLock
	{
		return true;
	}	
	if(((event.keyCode>=48) && (event.keyCode<=57))
		||((event.keyCode>=96) && (event.keyCode<=105)))/*0~9*//*小键盘0~9*/
	{
//			alert(event.keyCode);	
		if(event.srcElement.value.length==3)
		{
			if(i<3)
			{
				document.getElementsByName("IPInput")[i+1].focus();
				document.getElementsByName("IPInput")[i+1].value=document.getElementsByName("IPInput")[i+1].value;				
			}
		}
		return true;
	}
	else
	{
//		alert(event.keyCode);
		event.returnValue =false;			
		return true;
	}
}
</script>
<form id="FormNetifcfg" name="FormNetifcfg">
  <table>
	<tr> 
      <td colspan=3 ><font size="2" weight="bold" ><b>IP设置:</b></font></td>
    </tr>
    <tr> 
	<td >当前值:[<label id="LB_FormNetifcfg_Param_Ip_Br0">LB_FormNetifcfg_Param_Ip_Br0</label>]</td>   
	<td ><font size="2" weight="bold" ><b>请输入IP(2,):</b></font></td>
      <td> 
	<script language="JScript">
	var IPlikeInputStr=[]; 
	for(var i=0;i<4;i++)
	 IPlikeInputStr[i]="<input class=IPInput name=IPInput type=text size=3 maxlength=3 onpaste=\"return false;\"  onkeydown='IPKeydown("+i+")';>"+(i==3?"":"."); 
	document.write("<div class=IPDiv>"+IPlikeInputStr.join("")+"</div>"); 
	</script>      		
      </td>	
      	<td ><input type="button" value="确定" id="FormNetifcfg_Button_Submit"  onClick="FormNetifcfg_Submit();">   </td>
    </tr>
  </table>

</form>

<form id="FormDrps" name="FormDrps">
  <table>
      <tr> 
      <td colspan=3 ><font size="2" weight="bold" ><b>带宽设置(^DRPS 保存到NVRAM，下电并重新开机进出飞行生效):</b></font></td>
    </tr>
    <tr> 
	<td >当前值:[<label id="LB_FormDrps_Param_Bandwidth">LB_FormDrps_Param_Bandwidth</label>]</td>    
      <td ><font size="2" weight="bold" >
	    <select name="FormDrps_Param_Bandwidth" id="FormDrps_Param_Bandwidth">
          <option value='1'>3M</option>
          <option value='2'>5M</option>
          <option value='3'>10M</option>          
          <option value='255' selected ="selected">选择操作</option>          
        </select> </font></td>
	<td ><input type="button" value="确定" id="FormDrps_Button_Submit"  onClick="FormDrps_Submit();"> </td>         
    </tr>
  </table>
</form>

<form id="FormDfhc" name="FormDfhc">
  <table>
    <tr> 
      <td colspan=3 ><font size="2" weight="bold" ><b>跳频开关(设置后可立即生效):</b></font></td>
    </tr>  
    <tr> 
      <td >当前状态:[<label id="LB_FormDfhc_Param_N">LB_FormDfhc_Param_N</label>]</td>    
      <td ><font size="2" weight="bold" >
	    <select name="FormDfhc_Param_N" id="FormDfhc_Param_N">
          <option value='0'>关闭</option>
          <option value='1'>开启</option>
          <option value='255' selected ="selected">选择操作</option>          
        </select> </font></td>
	<td ><input type="button" value="确定" id="FormDfhc_Button_Submit"  onClick="FormDfhc_Submit();">  </td>    
    </tr>
  </table>
</form>



<form id="FormDrpc" name="FormDrpc">
  <table>

    <tr> 
      <td colspan=3 ><font size="2" weight="bold" ><b>建联组设置:</b></font></td>
    </tr>
    <tr> 
      <td colspan=3 ><font size="2" weight="bold" ><b>带宽设置:</b><input type ="radio" name ="DrpcRadio" id="DrpcRadioA" checked  value="1" style="display:none"></font></td>
		<td colspan=3 ><font size="2" weight="bold" ><b>当前值:[<label id="LB_FormDrpc_Param_Bandwidth">LB_FormDrpc_Param_Bandwidth</label>]</b></font></td>
      <td ><font size="2" weight="bold" >
	    <select name="FormDrpc_Param_Bandwidth" id="FormDrpc_Param_Bandwidth">
          <option value='1'>3M</option>
          <option value='2'>5M</option>
          <option value='3'>10M</option>          
          <option value='255' selected ="selected">选择操作</option>          
        </select> </font></td>		
    </tr>   
      <td colspan=3 ><font size="2" weight="bold" ><b>功率设置(1~25):</b><input type ="radio" name ="DrpcRadio" id="DrpcRadioB" value="2" style="display:none"></font></td>
		<td colspan=3 ><font size="2" weight="bold" ><b>当前值:[<label id="LB_FormDrpc_Param_Power">LB_FormDrpc_Param_Power</label>]</b></font></td>
      <td> <font size="2" weight="bold" >
      		<input type="text"   name="FormDrpc_Param_Power" maxlength="15" size="20" id="FormDrpc_Param_Power" ></font>
      </td>		
    </tr> 
    </tr>   
      <td colspan=3 ><font size="2" weight="bold" ><b>频点设置(24015-24814,8060-8259,14279-14478):</b><input type ="radio" name ="DrpcRadio" id="DrpcRadioC" value="3" style="display:none"></font></td>
		<td colspan=3 ><font size="2" weight="bold" ><b>当前值:[<label id="LB_FormDrpc_Param_Freq">LB_FormDrpc_Param_Freq</label>]</b></font></td>
      <td> <font size="2" weight="bold" >
      		<input type="text"   name="FormDrpc_Param_Freq" maxlength="15" size="20" id="FormDrpc_Param_Freq" ></font>
      </td>		
    </tr>     
  </table>
<input type="button" value="确定" id="FormDrpc_Button_Submit"  onClick="FormDrpc_Submit();">  
</form>

</table>


</body>
</blockquote>
</html>


